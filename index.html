<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dolarpan Calc - Beta</title>
    <link rel="stylesheet" href="https://unpkg.com/@picocss/pico@latest/css/pico.min.css">
    <script defer src="https://unpkg.com/alpinejs@3.10.4/dist/cdn.min.js"></script>
</head>

<body>
    <main class="container">
        <h3>Calcular precios</h3>
        <div x-data="load()">
            <!-- First we get the exchange rate -->
            <label for="rate">Tasa Bs.</label>
            <input id="rate" x-model="rate" placeholder="0.00" type="number" step="0.01" required>
            <hr>
            <!-- Get the item description -->
            <label for="desc">Articulo</label>
            <input id="desc" x-model="desc" placeholder="Descripcion" type="text">
            <!-- Precio-->
            <label for="price">Precio</label>
            <input id="price" x-model="price" placeholder="0.00" type="number" step="0.01">
            <!-- Radio input -->

            <template x-for="(currency, index) in currencies" :key="index">
                <div>
                    <input x-model="moneda" type="radio" :value="currency" :id="index">
                    <label :for="index" x-text="currency"></label>
                </div>
            </template>
            <br><br>
            <button x-on:click="addItem">Agregar</button>
            <hr>
            <table>
                <tr>
                    <th>Description</th>
                    <th>Bs</th>
                    <th>$</th>
                    <th>-</th>
                </tr>
                <template x-for="(item, index) in items" :key="index">
                    <tr>
                        <td x-text="item.desc"></td>
                        <td x-text="item.ves_price"></td>
                        <td x-text="item.usd_price"></td>
                        <td><button @click="deleteItem(index)">X</button></td>
                    </tr>
                </template>
                <!-- Calcular total en ambas monedas -->
            </table>
        </div>
    </main>
    <script>
        function load() {
            return {
                rate: "",
                items: [],
                desc: "",
                price: "",
                moneda: "Bolivar",
                currencies: ["Bolivar", "Dolar"],
                addItem() {
                    if (this.moneda == "Dolar") {
                        tmp_usd = price.value
                        tmp_ves = tmp_usd * rate.value
                    } else {
                        tmp_ves = price.value
                        tmp_usd = tmp_ves / rate.value
                    }
                    this.items.push({
                        desc: desc.value,
                        ves_price: parseFloat(tmp_ves).toFixed(2),
                        usd_price: parseFloat(tmp_usd).toFixed(2)
                    })
                    this.desc = ""
                    this.price = ""
                },
                deleteItem(index) {
                    this.items = this.items.filter((items, itemIndex) => {
                        return index !== itemIndex
                    })
                }
            }
        }
    </script>
</body>
</html>